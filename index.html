<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERLC: Hackowanie Systemu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #0a0a0a;
            color: #0f0;
            user-select: none;
            overflow: hidden;
        }
        
        .grid-cell {
            transition: all 0.2s;
        }
        
        .grid-cell.active {
            box-shadow: 0 0 10px #0f0;
        }
        
        .grid-cell.clicked {
            transform: scale(0.95);
        }
        
        @keyframes blink {
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-4">
    <!-- Intro Screen -->
    <div id="intro-screen" class="text-center max-w-md">
        <h1 class="text-2xl mb-4 text-green-500">ERLC HACKING TERMINAL</h1>
        <p class="mb-6">Włamujesz się do systemu policyjnego Los Santos.<br>Musisz przejąć kontrolę nad terminalem przed wykryciem.</p>
        <button id="start-btn" class="bg-green-900 hover:bg-green-800 px-6 py-2 rounded">START HACKING</button>
    </div>
    
    <!-- Game Screen -->
    <div id="game-screen" class="hidden w-full max-w-md">
        <div class="flex justify-between mb-4">
            <div>Czas: <span id="time">60</span>s</div>
            <div>Wynik: <span id="score">0</span></div>
            <div>Poziom: <span id="level">1</span></div>
        </div>
        
        <div id="grid-container" class="grid grid-cols-4 gap-2 mb-4">
            <!-- Cells will be generated by JavaScript -->
        </div>
        
        <div class="text-center">
            <div id="message" class="mb-2 h-6"></div>
            <button id="restart-btn" class="hidden bg-red-900 hover:bg-red-800 px-4 py-1 rounded">Spróbuj ponownie</button>
        </div>
    </div>
    
    <script>
        // Game variables
        let score = 0;
        let timeLeft = 60;
        let level = 1;
        let gameActive = false;
        let timer;
        
        // DOM elements
        const introScreen = document.getElementById('intro-screen');
        const gameScreen = document.getElementById('game-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const timeDisplay = document.getElementById('time');
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('level');
        const messageDisplay = document.getElementById('message');
        const gridContainer = document.getElementById('grid-container');
        
        // Game start
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);
        
        function startGame() {
            // Reset game state
            score = 0;
            timeLeft = 60;
            level = 1;
            gameActive = true;
            
            // Update displays
            scoreDisplay.textContent = score;
            timeDisplay.textContent = timeLeft;
            levelDisplay.textContent = level;
            messageDisplay.textContent = '';
            
            // Switch screens
            introScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            restartBtn.classList.add('hidden');
            
            // Start timer
            timer = setInterval(() => {
                timeLeft--;
                timeDisplay.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            
            // Generate initial grid
            generateGrid();
        }
        
        function generateGrid() {
            // Clear grid
            gridContainer.innerHTML = '';
            
            // Size depends on level
            const gridSize = 4 + Math.floor(level / 2);
            const gridArea = gridSize * gridSize;
            const activeCells = Math.min(3 + level, gridArea);
            
            // Create cells
            const cells = [];
            for (let i = 0; i < gridArea; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell bg-black border border-green-800 aspect-square flex items-center justify-center cursor-pointer';
                cell.dataset.active = 'false';
                
                cell.addEventListener('click', () => {
                    if (!gameActive || cell.dataset.active !== 'true') return;
                    
                    // Mark as clicked
                    cell.dataset.active = 'false';
                    cell.classList.remove('active');
                    cell.classList.add('clicked', 'bg-green-900');
                    
                    // Update score
                    score += level;
                    scoreDisplay.textContent = score;
                    
                    // Random message
                    const messages = [
                        "Dostęp przyznany!", 
                        "Hasło złamane!", 
                        "Firewall pominięty!", 
                        "Dane przechwycone!",
                        "System zhakowany!"
                    ];
                    messageDisplay.textContent = messages[Math.floor(Math.random() * messages.length)];
                    
                    // Check if all cells clicked
                    if (document.querySelectorAll('[data-active="true"]').length === 0) {
                        levelUp();
                    }
                });
                
                gridContainer.appendChild(cell);
                cells.push(cell);
                
                // Adjust grid
                gridContainer.className = `grid grid-cols-${gridSize} gap-2 mb-4`;
            }
            
            // Activate random cells
            const shuffled = cells.sort(() => 0.5 - Math.random());
            for (let i = 0; i < activeCells; i++) {
                shuffled[i].dataset.active = 'true';
                shuffled[i].classList.add('active', 'bg-green-700');
            }
            
            // Set timeout for cells to deactivate
            const cellTimeout = 2000 - (level * 100);
            setTimeout(() => {
                if (!gameActive) return;
                
                document.querySelectorAll('[data-active="true"]').forEach(cell => {
                    cell.dataset.active = 'false';
                    cell.classList.remove('active');
                    cell.classList.add('bg-red-900');
                    
                    // Punish for missed cells
                    score = Math.max(0, score - level);
                    scoreDisplay.textContent = score;
                });
                
                // Show fail message if all cells missed
                if (document.querySelectorAll('[data-active="false"]').every(cell => cell.classList.contains('bg-red-900'))) {
                    messageDisplay.textContent = "Przegapione cele! Szybciej!";
                }
                
                // Generate new grid after delay
                setTimeout(() => {
                    if (gameActive) generateGrid();
                }, 1000);
            }, cellTimeout);
        }
        
        function levelUp() {
            level++;
            levelDisplay.textContent = level;
            messageDisplay.textContent = `Poziom ${level}!`;
            
            setTimeout(() => {
                if (gameActive) generateGrid();
            }, 1000);
        }
        
        function endGame() {
            gameActive = false;
            clearInterval(timer);
            
            messageDisplay.textContent = `Koniec gry! Twój wynik: ${score}`;
            restartBtn.classList.remove('hidden');
            
            // Clear grid
            gridContainer.innerHTML = '';
        }
    </script>
</body>
</html>
